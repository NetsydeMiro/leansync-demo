(this["webpackJsonpleansync-demo"]=this["webpackJsonpleansync-demo"]||[]).push([[0],[,,,,,,,,,,,,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg=="},,,,,,function(e,t,n){e.exports=n(33)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},,,function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(16),s=n.n(a),i=(n(23),n(24),n(25),n(12)),l=n.n(i),o=(n(26),function(){return c.a.createElement("header",null,c.a.createElement("div",null,c.a.createElement("h1",{className:"title is-1"},"LeanSync Demo (Alpha)")),c.a.createElement("div",null,c.a.createElement("a",{href:"https://github.com/NetsydeMiro/leansync"},c.a.createElement("img",{src:l.a,className:"App-logo",alt:"logo"}),"LeanSync Algorithm Repo"),c.a.createElement("br",null),c.a.createElement("a",{href:"https://github.com/NetsydeMiro/leansync-demo"},c.a.createElement("img",{src:l.a,className:"App-logo",alt:"logo"}),"LeanSync Demo Repo")))}),u=n(5),d=(n(27),n(28),n(8)),p=function(e){return c.a.createElement("div",{className:"server-note"},e.noteText)},m=function(e){var t=e.notes.map((function(e,t){return c.a.createElement(p,{key:t,noteText:e.text})})),n=d.a.map((function(e){return c.a.createElement("option",{value:e},e)}));return c.a.createElement("div",{className:"computer server"},c.a.createElement("div",{className:"computer-header"},c.a.createElement("h3",{className:"title is-3"},"Server"),c.a.createElement("button",{className:"button",onClick:function(){return e.dispatch({type:"addClient"})}},"Add Client")),c.a.createElement("div",{className:"computer-wrapper server-wrapper"},c.a.createElement("div",{className:"server-notes"},t),c.a.createElement("div",{id:"resolution-strategy"},c.a.createElement("label",null,"Conflict Resolution Strategy ",c.a.createElement("br",null),c.a.createElement("div",{className:"select"},c.a.createElement("select",{onChange:function(t){e.dispatch({type:"setResolutionStrategy",strategy:t.target.value})}},n))))))},f=n(2),v=(n(30),n(3)),y=n(4),h=n(11),b=n(6),E=n(9),g=n(10),A=n(1),w=n.n(A);function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return{id:Object(g.v1)().toString(),text:e,updatedAt:t}}var N=function(e){function t(){return Object(v.a)(this,t),Object(h.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(y.a)(t,null,[{key:"createPopulated",value:function(e,n){for(var r=new t,c=1;c<=e;c++)r.add(S("Note ".concat(c),n),n);return r}}]),t}(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return Object(g.v1)().toString()};Object(v.a)(this,e),this.newKey=n,this.rows=void 0,this.clone=function(e){return e.map((function(e){return Object.assign({},e)}))},this.rows=this.clone(t)}return Object(y.a)(e,[{key:"getByKey",value:function(e){var t;return w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.rows.filter((function(t){return e.includes(t.id)})),n.abrupt("return",this.clone(t));case 2:case"end":return n.stop()}}),null,this)}},{key:"getSyncedSince",value:function(e){var t;return w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.rows.filter((function(t){return!e||t.syncedAt&&t.syncedAt>e})),n.abrupt("return",this.clone(t));case 2:case"end":return n.stop()}}),null,this)}},{key:"update",value:function(e,t,n){var r,c,a,s,i,l,o;return w.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:for((r=this.rows.find((function(t){return t.id==(n||e.id)})))||(r={},this.rows.push(r)),c=!0,a=!1,s=void 0,u.prev=5,i=Object.keys(e)[Symbol.iterator]();!(c=(l=i.next()).done);c=!0)o=l.value,r[o]=e[o];u.next=13;break;case 9:u.prev=9,u.t0=u.catch(5),a=!0,s=u.t0;case 13:u.prev=13,u.prev=14,c||null==i.return||i.return();case 16:if(u.prev=16,!a){u.next=19;break}throw s;case 19:return u.finish(16);case 20:return u.finish(13);case 21:return r.syncedAt=t,u.abrupt("return",Object.assign(r,{}));case 23:case"end":return u.stop()}}),null,this,[[5,9,13,21],[14,,16,20]])}},{key:"add",value:function(e,t){var n;return w.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:for((n=Object.assign({},e)).syncedAt=t;this.rows.some((function(e){return e.id==n.id}));)n.id=this.newKey();return this.rows.push(n),r.abrupt("return",Object.assign({},n));case 5:case"end":return r.stop()}}),null,this)}},{key:"getRequiringSync",value:function(){var e;return w.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.rows.filter((function(e){return!e.syncedAt||e.updatedAt>e.syncedAt})),t.abrupt("return",this.clone(e));case 2:case"end":return t.stop()}}),null,this)}},{key:"MarkConflicted",value:function(e){var t;return w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:(t=this.rows.find((function(t){return t.id==e.id})))&&(t.conflict=JSON.stringify(e));case 2:case"end":return n.stop()}}),null,this)}}]),e}()),x=n(17),k=n.n(x),j=function(e){var t=e.hasChanges,n=k()({"client-note":!0,hasChanges:t});return c.a.createElement("textarea",{value:e.noteText,onChange:function(t){return e.onChange(t.target.value)},className:n})},I=function(e){var t=Object(r.useState)(e.notes),n=Object(u.a)(t,2),a=n[0],s=n[1];Object(r.useEffect)((function(){s(e.notes)}),[e.notes]);var i=a.map((function(t,n){var r,i=e.notes.length>n&&e.notes[n],l=!i||t.text!=i.text;return c.a.createElement(j,{key:t.id,noteText:t.text,hasChanges:l,onChange:(r=n,function(e){var t=a.slice(),n=Object(f.a)({},t[r]);n.text=e,t[r]=n,s(t)})})}));return c.a.createElement("div",{className:"computer client"},c.a.createElement("div",{className:"computer-header"},c.a.createElement("h2",{className:"title is-3"},"Client",c.a.createElement("a",{className:"remove",title:"Remove Client",onClick:function(){e.dispatch({type:"removeClient",clientIndex:e.clientIndex})}})),c.a.createElement("label",{className:"offline checkbox"},c.a.createElement("input",{type:"checkbox",onClick:function(){e.dispatch({type:"setClientOffline",clientIndex:e.clientIndex,isOffline:!e.isOffline})}}),"Offline")),c.a.createElement("div",{className:"computer-wrapper client-wrapper"},c.a.createElement("div",{className:"client-notes"},i),c.a.createElement("div",{className:"client buttons are-small"},c.a.createElement("button",{title:"Add Note",className:"new button is-success is-outlined",onClick:function(){var e=a.slice();e.push(S("")),s(e)}},c.a.createElement("span",null)),c.a.createElement("button",{title:"Sync Notes",className:"sync button is-link is-outlined",onClick:function(){e.dispatch({type:"requestSync",clientIndex:e.clientIndex,clientNotes:a})}},c.a.createElement("span",null)))))};var R={server:{notes:[],resolutionStrategy:"takeClient"},clients:[]};function O(e,t){var n;switch(t.type){case"setResolutionStrategy":n=function(e,t){var n=Object(f.a)({},e);return n.server=Object(f.a)({},e.server,{resolutionStrategy:t}),n}(e,t.strategy);break;case"addClient":n=function(e){var t=Object(f.a)({},e);return t.clients=e.clients.slice(),t.clients.push({notes:[]}),t}(e);break;case"removeClient":n=function(e,t){var n=Object(f.a)({},e);return n.clients=e.clients.slice(),n.clients.splice(t,1),n}(e,t.clientIndex);break;case"setClientOffline":n=function(e,t,n){var r=Object(f.a)({},e);return r.clients=e.clients.slice(),r.clients[t]=Object(f.a)({},e.clients[t],{isOffline:n}),r}(e,t.clientIndex,t.isOffline);break;case"requestSync":n=function(e,t,n){var r=Object(f.a)({},e),c={clientIndex:t,clientNotes:n};return r.syncRequest=c,r}(e,t.clientIndex,t.clientNotes);break;case"processSync":n=function(e,t,n,r,c){var a=Object(f.a)({},e),s=Object(f.a)({},a.server);s.notes=r;var i=a.clients.slice(),l=Object(f.a)({},i[t]);return l.notes=n,l.lastSync=c,i[t]=l,a.clients=i,a.server=s,delete a.syncRequest,a}(e,t.clientIndex,t.clientNotes,t.serverNotes,t.syncStamp);break;default:!function(e){throw new Error("Unexpected object: "+e)}(t)}return n}var M=function(){var e=Object(r.useReducer)(O,R),t=Object(u.a)(e,2),n=t[0],a=t[1];Object(r.useEffect)((function(){n.syncRequest&&function(e,t,n){var r,c,a,s,i,l,o,u,p;return w.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:return r=new N(e.server.notes),c=new N(n),a={entityKey:function(e){return e.id},entityLastUpdated:function(e){return e.updatedAt},areEntitiesEqual:function(e,t){return e.text==t.text},getServerEntities:r.getByKey.bind(r),getServerEntitiesSyncedSince:r.getSyncedSince.bind(r),updateServerEntity:r.update.bind(r),createServerEntity:r.add.bind(r),conflictResolutionStrategy:e.server.resolutionStrategy},s=new d.c(a),i=e.clients[t],l=new Date,o={keySelector:function(e){return e.id},getClientEntitiesRequiringSync:c.getRequiringSync.bind(c),getClientEntities:c.getByKey.bind(c),getLastSyncStamp:function(){return w.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.lastSync);case 1:case"end":return e.stop()}}))},markSyncStamp:function(e){return w.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:l=e;case 1:case"end":return t.stop()}}))},updateEntity:function(e,t,n){return w.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:c.update(e,t,n);case 1:case"end":return r.stop()}}))},createEntity:function(e){return w.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:c.add(e);case 1:case"end":return t.stop()}}))},syncWithServer:function(e,t){return w.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",s.sync(e,t));case 1:case"end":return n.stop()}}))}},u=new d.b(o),m.next=10,w.a.awrap(u.sync());case 10:return p={type:"processSync",clientIndex:t,serverNotes:r.rows,clientNotes:c.rows,syncStamp:l},m.abrupt("return",p);case 12:case"end":return m.stop()}}))}(n,n.syncRequest.clientIndex,n.syncRequest.clientNotes).then((function(e){return a(e)})).catch((function(e){throw e}))}));var s=n.clients.map((function(e,t){return c.a.createElement(I,{key:t,clientIndex:t,notes:e.notes,dispatch:a})}));return c.a.createElement("div",null,c.a.createElement("div",{className:"computers"},c.a.createElement(m,{notes:n.server.notes,resolutionStrategy:n.server.resolutionStrategy,dispatch:a}),s))},B=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(o,null),c.a.createElement(M,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[18,1,2]]]);
//# sourceMappingURL=main.c1ffe699.chunk.js.map